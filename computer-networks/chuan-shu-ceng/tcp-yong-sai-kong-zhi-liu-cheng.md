---
description: TCP 拥塞控制采用的四种算法是什么？
---

# TCP 拥塞控制流程？

## TCP拥塞控制

### 慢开始 

当发送方开始发送数据时，由于一开始不知道网络负荷情况，如果立即将大量的数据字节传输到网络中，那么就有可能引起网络拥塞。一个较好的方法是在一开始发送少量的数据先探测一下网络状况，即由小到大的增大发送窗口（拥塞窗口cwnd）。慢开始的慢指的是初始时令cwnd为 1，即一开始发送一个报文段。如果收到确认，则 cwnd = 2，之后每收到一个确认报文，就令 cwnd = cwnd \* 2。

但是，为了防止拥塞窗口增长过大而引起网络拥塞，另外设置了一个慢开始门限 ssthresh：

* 当 cwnd &lt; ssthresh 时，使用上述的慢开始算法；
* 当 cwnd ≥ ssthresh 时，停止使用慢开始，转而使用拥塞避免算法。

## 拥塞避免

拥塞控制是为了让拥塞窗口 cwnd 缓慢地增大，即每经过一个往返时间 RTT （往返时间定义为发送方发送数据到收到确认报文所经历的时间）就把发送方的 cwnd 值加 1，通过让 cwnd 线性增长，防止很快就遇到网络拥塞状态。

当网络拥塞发生时，让新的慢开始门限值变为发生拥塞时候的值的一半，并将拥塞窗口置为 1，然后再次重复两种算法（慢开始和拥塞避免），这时一瞬间会将网络中的数据量大量降低。

## 快重传

快重传算法要求接收方每收到一个失序的报文就立即发送重复确认，而不要等到自己发送数据时才捎带进行确认，假定发送方发送了 Msg 1 ~ Msg 4 这 4 个报文，已知接收方收到了 Msg 1，Msg 3 和 Msg 4 报文，此时因为接收到收到了失序的数据包，按照快重传的约定，接收方应立即向发送方发送 Msg 1 的重复确认。 于是在接收方收到 Msg 4 报文的时候，向发送方发送的仍然是 Msg 1 的重复确认。这样，发送方就收到了 3 次 Msg 1 的重复确认，于是立即重传对方未收到的 Msg 报文（从2开始）。由于发送方尽早重传未被确认的报文段，因此，快重传算法可以提高网络的吞吐量。

## 快恢复

![](../../.gitbook/assets/image%20%2814%29.png)

快恢复算法（TCP Reno）是和快重传算法配合使用的，该算法主要有以下两个要点：

1. 当发送方连续收到三个重复确认，将ssthresh设置为当前拥塞窗口cwnd的一半。重传丢失的报文段。设置cwnd为ssthresh加上3倍的报文段大小；
2. 之后线性增大cwnd，每次加1。

## Reference

1. [https://www.huaweicloud.com/articles/912cb7c3b49f2a5bc792a140bb4d7a87.html](https://www.huaweicloud.com/articles/912cb7c3b49f2a5bc792a140bb4d7a87.html)

