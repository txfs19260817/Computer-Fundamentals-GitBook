---
description: 缓存雪崩是什么？如何解决？
---

# 缓存雪崩如何解决？

## 缓存雪崩

### 问题

![](../../.gitbook/assets/image%20%2853%29.png)

缓存层不可用，导致大量请求直接打到数据库，最终由于数据库压力过大可能导致系统崩掉。缓存层不可用指以下两方面：

* 缓存服务器宕机，系统将请求打到数据库；
* 缓存数据突然大范围集中过期失效，导致大量请求打到数据库重新加载数据。

### 解决方法

#### 缓存预热

在高峰期还没到来时，提前将热数据加载到缓存中，避免高峰期来临时数据库压力过大。

#### 均匀设置过期时间

对不同的热点数据，将过期时间加上一个随机值，让过期时间不集中在一个点，从而减小很大部分数据库压力。

#### 多级缓存

除了使用Redis缓存，还可以根据业务增加一些热点数据的其他缓存，比如内存缓存，可以将各级的缓存有效期分开，这种方式也能缓解数据库的压力。

#### 限流

依靠中间件或消息队列等，保证系统的可用。

#### 加互斥锁

第一个用户操作向缓存中重新加载数据，让其他请求等待。如果要用，要注意锁的性能和稳定性。

#### 使用高可用架构

主从复制、哨兵、集群等

## Reference

1. [https://blog.csdn.net/qq\_43255017/article/details/108396782](https://blog.csdn.net/qq_43255017/article/details/108396782)
2. [https://zhuanlan.zhihu.com/p/353644479](https://zhuanlan.zhihu.com/p/353644479)

